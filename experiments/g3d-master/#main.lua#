-- written by groverbuger for g3d
-- january 2021
-- MIT license

g3d = require "g3d"

function generate3dShapeFrom2d(shape)
   local result = {}
   for i = 1, #shape do
      result[i] = {shape[i][1]/100, shape[i][2]/100, 0}
   end
   return result
end


function love.load()

   local derp3 = { { 55.990001678467, 21.14999961853 }, { 61.75, 19.139999389648 }, { 61.720001220703, 22.229999542236 }, { 55.990001678467, 21.14999961853 }, { 61.720001220703, 22.229999542236 }, { 59.790000915527, 31.260000228882 }, { 55.990001678467, 21.14999961853 }, { 59.790000915527, 31.260000228882 }, { 48.619998931885, 31.690000534058 }, { 15.10000038147, 30.889999389648 }, { 13.840000152588, 23.540000915527 }, { 16.819999694824, 24.420000076294 }, { 15.10000038147, 30.889999389648 }, { 16.819999694824, 24.420000076294 }, { 22.840000152588, 25.559999465942 }, { 15.10000038147, 30.889999389648 }, { 22.840000152588, 25.559999465942 }, { 31.959999084473, 25.930000305176 }, { 15.10000038147, 30.889999389648 }, { 31.959999084473, 25.930000305176 }, { 44.110000610352, 24.370000839233 }, { 44.110000610352, 24.370000839233 }, { 55.990001678467, 21.14999961853 }, { 48.619998931885, 31.690000534058 }, { 44.110000610352, 24.370000839233 }, { 48.619998931885, 31.690000534058 }, { 15.10000038147, 30.889999389648 } }

   local derp = { { 294, 363 }, { 269, 322 }, { 276, 272 }, { 294, 363 }, { 276, 272 }, { 349, 219 }, { 294, 363 }, { 349, 219 }, { 403, 221 }, { 294, 363 }, { 403, 221 }, { 458, 270 }, { 294, 363 }, { 458, 270 }, { 461, 336 }, { 294, 363 }, { 461, 336 }, { 423, 386 }, { 423, 386 }, { 383, 469 }, { 356, 464 }, { 423, 386 }, { 356, 464 }, { 359, 385 }, { 423, 386 }, { 359, 385 }, { 332, 383 }, { 332, 383 }, { 270, 430 }, { 240, 416 }, { 332, 383 }, { 240, 416 }, { 294, 363 }, { 332, 383 }, { 294, 363 }, { 423, 386 } }

   local derp2 = { { -132.65313720703, 149.34225463867 }, { -234.65313720703, 84.342254638672 }, { -217.65313720703, 12.342254638672 }, { -132.65313720703, 149.34225463867 }, { -217.65313720703, 12.342254638672 }, { -81.653137207031, -4.6577453613281 }, { -132.65313720703, 149.34225463867 }, { -81.653137207031, -4.6577453613281 }, { -29.653137207031, 67.342254638672 }, { -132.65313720703, 149.34225463867 }, { -29.653137207031, 67.342254638672 }, { 51.346862792969, 49.342254638672 }, { 92.346862792969, -25.657745361328 }, { 133.68267822266, -367.34225463867 }, { 234.65313720703, -344.90438842773 }, { 92.346862792969, -25.657745361328 }, { 234.65313720703, -344.90438842773 }, { 186.57196044922, -17.952301025391 }, { 92.346862792969, -25.657745361328 }, { 186.57196044922, -17.952301025391 }, { 178.34686279297, 73.342254638672 }, { 92.346862792969, -25.657745361328 }, { 178.34686279297, 73.342254638672 }, { 132.34686279297, 157.34225463867 }, { 92.346862792969, -25.657745361328 }, { 132.34686279297, 157.34225463867 }, { 74.346862792969, 367.34225463867 }, { 92.346862792969, -25.657745361328 }, { 74.346862792969, 367.34225463867 }, { 53.346862792969, 145.34225463867 }, { -38.653137207031, 171.34225463867 }, { -81.653137207031, 348.34225463867 }, { -132.65313720703, 149.34225463867 }, { -38.653137207031, 171.34225463867 }, { -132.65313720703, 149.34225463867 }, { 51.346862792969, 49.342254638672 }, { 51.346862792969, 49.342254638672 }, { 92.346862792969, -25.657745361328 }, { 53.346862792969, 145.34225463867 }, { 51.346862792969, 49.342254638672 }, { 53.346862792969, 145.34225463867 }, { -38.653137207031, 171.34225463867 } }

   --Thing = g3d.newModel({{0,0,0},{5,0,0},{2,2,0}},  "assets/whitepixel.png", {0,0,0})
   Thing = g3d.newModel(generate3dShapeFrom2d(derp3 ),  "assets/whitepixel.png", {0,0,0})

    Earth = g3d.newModel("assets/sphere.obj", "assets/earth.png", {0,0,4})
    Moon = g3d.newModel("assets/sphere.obj", "assets/moon.png", {5,0,4}, nil, {0.5,0.5,0.5})
    Background = g3d.newModel("assets/sphere.obj", "assets/iper.jpeg", {0,0,0}, nil, {500,500,500})
    Timer = 0
end


function love.keypressed(k)
   if k == "escape" then love.event.quit() end
end

function love.mousemoved(x,y, dx,dy)
    g3d.camera.firstPersonLook(dx,dy)
end

function love.update(dt)
    Timer = Timer + dt
    Moon:setTranslation(math.cos(Timer)*5, 0, math.sin(Timer)*5 +4)
    Moon:setRotation(0,-1*Timer,0)
    Thing:setRotation(0,-1*Timer,0)
    g3d.camera.firstPersonMovement(dt)
end

function love.draw()
   love.graphics.setColor(1,1,1)
    Earth:draw()
    Moon:draw()
    love.graphics.setColor(1,0,0)
    Thing:draw()
    love.graphics.setColor(1,1,1)
    Background:draw()
end
